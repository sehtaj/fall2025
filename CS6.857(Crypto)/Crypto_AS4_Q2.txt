## a)

In ElGamal encryption, every time we encrypt a message we choose a random value r. This r is very important for security. This r should be completely random, but mostly people use generators like linear congruential generators (LCG).

In an LCG, the next value is generated using the formula:

r_next = a * r_previous + b mod group size

Here a and b are public values

Now suppose two messages are encrypted using ElGamal and the randomness is generated using LCG. Let the randomness used in the first encryption be r1 and in the second encryption be r2. Since LCG is used, we know that r2 is directly related to r1 and is not independent.

In ElGamal, a ciphertext has the form:

(g^r , m * h^r)

So the first ciphertext contains g^r1 and the second ciphertext contains g^r2

From the LCG formula, we have:

r2 = a * r1 + b

So g^r2 = g^(a * r1 + b)

This can be rewritten as: g^r2 = (g^r1)^a * g^b

This means the first part of the second ciphertext can be computed directly from the first part of the first ciphertext. As a, b and g are public, anyone can check whether this relation holds

If r was chosen at random, there would be no such fixed relation between g^r1 and g^r2 but as LCG is used, the ciphertexts are linked together in a way which can be predicted

## b)

Now suppose that the random value r used in ElGamal is generated using a strong pseudorandom generator(PRG) instead of an LCG

A strong PRG produces values that look random to anyone who does not know the secret seed. Even though the values are generated by a formula, no  attacker can tell whether the values are really random or generated by the PRG

Now if there is an attacker who can break ElGamal when this PRG is used. That means the attacker can look at many ciphertexts and correctly guess which messages were encrypted

Now imagine we are given some random-looking values. These values are either truly random or generated by a strong PRG. We use these values as r in ElGamal encryption and create ciphertexts

We give these ciphertexts to the attacker. If the attacker is able to distinguish the encryptions, then we can say that the values were generated by the PRG. If the attacker cannot distinguish, then the values were truly random

This means we are using the attacker to tell apart PRG output from real random values, which should not be possible if the PRG is secure

So our assumption must be wrong.

Therefore, ElGamal remains secure when the randomness is generated using a cryptographically strong pseudorandom generator.